{"version":3,"sources":["store/auth-actions.js","components/VisualFeedback/LogoutAlert.js"],"names":["signUser","requestObject","dispatch","authSliceActions","setAuthLoadingBtnState","axios","response","data","resData","setToken","accessToken","refreshToken","setToastData","loginUser","checkSession","errorData","logoutUser","signOutUser","getTokens","setProcess","setLoadingProcess","routeInstance","method","url","console","log","userSliceActions","setUserData","userId","userProfileImage","userName","userFullName","bio","undefined","setResultProcess","LogoutAlert","props","isOpen","onClose","useDispatch","history","useHistory","colorScheme","mr","onClick","then","removeTokens","resetUserData","replace"],"mappings":"oRAWaA,EAAW,SAACC,GACvB,8CAAO,WAAOC,GAAQ,2EAEsC,OAFtC,SAElBA,EAASC,IAAiBC,wBAAuB,IAAO,SACjCC,IAAMJ,GAAe,KAAD,EAA7B,OAARK,EAAQ,gBACQA,EAASC,KAAK,KAAD,EAII,OAJjCC,EAAO,OAEbC,YAASD,EAAQD,KAAKG,YAAaF,EAAQD,KAAKI,cAChDC,YAAaV,EAAUM,GACvBN,EAASC,IAAiBU,aAAa,UACjCC,YAAaZ,GAAU,KAAD,GAC5BA,EAASC,IAAiBC,wBAAuB,IAAQ,kDAEnDW,EAAY,KAAIT,SAASC,KAC/BK,YAAaV,EAAS,eAAMa,IAC5Bb,EAASC,IAAiBC,wBAAuB,IACjDD,IAAiBa,aAAa,0DAEjC,mDAjBD,IAoBWC,EAAc,WACzB,8CAAO,WAAOf,GAAQ,yEAGoC,OAHpC,SAEZS,EAAeO,cAAYP,aACjCQ,IAAWC,kBAAkBlB,EAAU,eAAe,SAC/BmB,YAAc,CACnCC,OAAQ,OACRC,IAAK,mBACLhB,KAAM,CAAEI,kBACP,KAAD,EAJIL,EAAQ,OAKdkB,QAAQC,IAAI,WAAYnB,GACxBJ,EACEwB,IAAiBC,YAAY,CAC3BC,OAAQ,KACRC,iBAAkB,KAClBC,SAAU,KACVC,aAAc,KACdC,SAAKC,KAGTd,IAAWe,iBAAiBhC,GAAU,EAAM,cAAc,kDAE1DiB,IAAWe,iBAAiBhC,GAAU,EAAO,uBAC7CU,YAAaV,GAAU,0DAE1B,mDAxBD,K,iCCjCF,yFAyDeiC,UAtCf,SAAqBC,GACnB,IAAQC,EAAoBD,EAApBC,OAAQC,EAAYF,EAAZE,QAEVpC,EAAWqC,cACXC,EAAUC,cAWhB,OACE,mCACE,eAAC,IAAK,CAACJ,OAAQA,EAAQC,QAASA,EAAQ,UACtC,cAAC,IAAY,IACb,eAAC,IAAY,WACX,cAAC,IAAW,UAAC,iBACb,cAAC,IAAgB,IACjB,cAAC,IAAS,UAAC,8BAEX,eAAC,IAAW,WACV,cAAC,IAAM,CAACI,YAAY,OAAOC,GAAI,EAAGC,QApBlB,WACxB1C,EAASe,eAAe4B,MAAK,WAC3BC,cACA5C,EAASwB,IAAiBqB,iBAC1B7C,EAASC,IAAiBa,cAC1BoB,EAAME,UACNE,EAAQQ,QAAQ,cAcmD,SAAC,WAG9D,cAAC,IAAM,CAACJ,QAASN,EAASI,YAAY,SAAQ,SAAC","file":"static/js/15.6f335840.chunk.js","sourcesContent":["import { authSliceActions } from \"./authSlice\";\r\n\r\nimport setToastData from \"../utils/showToast\";\r\nimport axios from \"axios\";\r\nimport { getTokens, setToken } from \"../utils/handleTokens\";\r\nimport checkSession from \"../utils/checkSession\";\r\nimport routeInstance from \"../api/routes.instance\";\r\nimport setProcess from \"../utils/setProcess\";\r\n\r\nimport { userSliceActions } from \"./userSlice\";\r\n\r\nexport const signUser = (requestObject) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch(authSliceActions.setAuthLoadingBtnState(true));\r\n      const response = await axios(requestObject);\r\n      const resData = await response.data;\r\n\r\n      setToken(resData.data.accessToken, resData.data.refreshToken);\r\n      setToastData(dispatch, resData);\r\n      dispatch(authSliceActions.loginUser());\r\n      await checkSession(dispatch);\r\n      dispatch(authSliceActions.setAuthLoadingBtnState(false));\r\n    } catch (err) {\r\n      const errorData = err.response.data;\r\n      setToastData(dispatch, { ...errorData });\r\n      dispatch(authSliceActions.setAuthLoadingBtnState(false));\r\n      authSliceActions.logoutUser();\r\n    }\r\n  };\r\n};\r\n\r\nexport const signOutUser = () => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const refreshToken = getTokens().refreshToken;\r\n      setProcess.setLoadingProcess(dispatch, \"Logging out\");\r\n      const response = await routeInstance({\r\n        method: \"post\",\r\n        url: \"/api/auth/logout\",\r\n        data: { refreshToken },\r\n      });\r\n      console.log(\"response\", response);\r\n      dispatch(\r\n        userSliceActions.setUserData({\r\n          userId: null,\r\n          userProfileImage: null,\r\n          userName: null,\r\n          userFullName: null,\r\n          bio: undefined,\r\n        })\r\n      );\r\n      setProcess.setResultProcess(dispatch, true, \"Logged out\");\r\n    } catch (err) {\r\n      setProcess.setResultProcess(dispatch, false, \"Action Unauthorized\");\r\n      setToastData(dispatch);\r\n    }\r\n  };\r\n};\r\n","import React from \"react\";\r\nimport {\r\n  Modal,\r\n  ModalOverlay,\r\n  ModalContent,\r\n  ModalHeader,\r\n  ModalFooter,\r\n  ModalBody,\r\n  ModalCloseButton,\r\n} from \"@chakra-ui/react\";\r\nimport { Button } from \"@chakra-ui/react\";\r\n\r\nimport { authSliceActions } from \"../../store/authSlice\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { signOutUser } from \"../../store/auth-actions\";\r\nimport { removeTokens } from \"../../utils/handleTokens\";\r\nimport { userSliceActions } from \"../../store/userSlice\";\r\n\r\nfunction LogoutAlert(props) {\r\n  const { isOpen, onClose } = props;\r\n\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const userLogoutHandler = () => {\r\n    dispatch(signOutUser()).then(() => {\r\n      removeTokens();\r\n      dispatch(userSliceActions.resetUserData());\r\n      dispatch(authSliceActions.logoutUser());\r\n      props.onClose();\r\n      history.replace(\"/login\");\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Modal isOpen={isOpen} onClose={onClose}>\r\n        <ModalOverlay />\r\n        <ModalContent>\r\n          <ModalHeader>Confirmation</ModalHeader>\r\n          <ModalCloseButton />\r\n          <ModalBody>Are you sure to log out ?</ModalBody>\r\n\r\n          <ModalFooter>\r\n            <Button colorScheme=\"blue\" mr={3} onClick={userLogoutHandler}>\r\n              Logout\r\n            </Button>\r\n            <Button onClick={onClose} colorScheme=\"yellow\">\r\n              Close\r\n            </Button>\r\n          </ModalFooter>\r\n        </ModalContent>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default LogoutAlert;\r\n"],"sourceRoot":""}